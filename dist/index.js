!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AnnoyingBird=t():e.AnnoyingBird=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(e){var t=S[e];if(!t)return u;var i=function(n){return t.hot.active?(S[n]?S[n].parents.indexOf(e)<0&&S[n].parents.push(e):(v=[e],l=n),t.children.indexOf(n)<0&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),v=[]),u(n)};for(var r in u)Object.prototype.hasOwnProperty.call(u,r)&&"e"!==r&&Object.defineProperty(i,r,function(e){return{configurable:!0,enumerable:!0,get:function(){return u[e]},set:function(t){u[e]=t}}}(r));return i.e=function(e){function t(){T--,"prepare"===A&&(_[e]||a(e),0===T&&0===k&&o())}return"ready"===A&&n("prepare"),T++,u.e(e).then(t,function(e){throw t(),e})},i}function n(e){A=e;for(var t=0;t<b.length;t++)b[t].call(null,e)}function i(e){return+e+""===e?+e:e}function r(e){if("idle"!==A)throw new Error("check() is only allowed in idle status");return g=e,n("check"),function(e){return e=e||1e4,new Promise(function(t,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var i=new XMLHttpRequest,r=u.p+""+p+".hot-update.json";i.open("GET",r,!0),i.timeout=e,i.send(null)}catch(e){return n(e)}i.onreadystatechange=function(){if(4===i.readyState)if(0===i.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===i.status)t();else if(200!==i.status&&304!==i.status)n(new Error("Manifest request to "+r+" failed."));else{try{var e=JSON.parse(i.responseText)}catch(e){return void n(e)}t(e)}}})}(y).then(function(e){if(!e)return n("idle"),null;P={},_={},x=e.c,h=e.h,n("prepare");var t=new Promise(function(e,t){d={resolve:e,reject:t}});return f={},a(0),"prepare"===A&&0===T&&0===k&&o(),t})}function a(e){x[e]?(P[e]=!0,k++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.src=u.p+""+e+"."+p+".hot-update.js",t.appendChild(n)}(e)):_[e]=!0}function o(){n("ready");var e=d;if(d=null,e)if(g)Promise.resolve().then(function(){return s(g)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var r in f)Object.prototype.hasOwnProperty.call(f,r)&&t.push(i(r));e.resolve(t)}}function s(t){function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.indexOf(i)<0&&e.push(i)}}if("ready"!==A)throw new Error("apply() is only allowed in ready status");var a,o,s,c,l;t=t||{};var d={},g=[],y={},w=function(){console.warn("[HMR] unexpected require("+k.moduleId+") to disposed module")};for(var b in f)if(Object.prototype.hasOwnProperty.call(f,b)){var k;l=i(b);var T=!1,_=!1,P=!1,M="";switch((k=f[b]?function(e){for(var t=[e],n={},i=t.slice().map(function(e){return{chain:[e],id:e}});i.length>0;){var a=i.pop(),o=a.id,s=a.chain;if((c=S[o])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:o};if(c.hot._main)return{type:"unaccepted",chain:s,moduleId:o};for(var u=0;u<c.parents.length;u++){var l=c.parents[u],d=S[l];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:s.concat([l]),moduleId:o,parentId:l};t.indexOf(l)>=0||(d.hot._acceptedDependencies[o]?(n[l]||(n[l]=[]),r(n[l],[o])):(delete n[l],t.push(l),i.push({chain:s.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}(l):{type:"disposed",moduleId:b}).chain&&(M="\nUpdate propagation: "+k.chain.join(" -> ")),k.type){case"self-declined":t.onDeclined&&t.onDeclined(k),t.ignoreDeclined||(T=new Error("Aborted because of self decline: "+k.moduleId+M));break;case"declined":t.onDeclined&&t.onDeclined(k),t.ignoreDeclined||(T=new Error("Aborted because of declined dependency: "+k.moduleId+" in "+k.parentId+M));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(k),t.ignoreUnaccepted||(T=new Error("Aborted because "+l+" is not accepted"+M));break;case"accepted":t.onAccepted&&t.onAccepted(k),_=!0;break;case"disposed":t.onDisposed&&t.onDisposed(k),P=!0;break;default:throw new Error("Unexception type "+k.type)}if(T)return n("abort"),Promise.reject(T);if(_)for(l in y[l]=f[l],r(g,k.outdatedModules),k.outdatedDependencies)Object.prototype.hasOwnProperty.call(k.outdatedDependencies,l)&&(d[l]||(d[l]=[]),r(d[l],k.outdatedDependencies[l]));P&&(r(g,[k.moduleId]),y[l]=w)}var O,I=[];for(o=0;o<g.length;o++)l=g[o],S[l]&&S[l].hot._selfAccepted&&I.push({module:l,errorHandler:S[l].hot._selfAccepted});n("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var C,D,j=g.slice();j.length>0;)if(l=j.pop(),c=S[l]){var E={},F=c.hot._disposeHandlers;for(s=0;s<F.length;s++)(a=F[s])(E);for(m[l]=E,c.hot.active=!1,delete S[l],delete d[l],s=0;s<c.children.length;s++){var N=S[c.children[s]];N&&(O=N.parents.indexOf(l))>=0&&N.parents.splice(O,1)}}for(l in d)if(Object.prototype.hasOwnProperty.call(d,l)&&(c=S[l]))for(D=d[l],s=0;s<D.length;s++)C=D[s],(O=c.children.indexOf(C))>=0&&c.children.splice(O,1);for(l in n("apply"),p=h,y)Object.prototype.hasOwnProperty.call(y,l)&&(e[l]=y[l]);var R=null;for(l in d)if(Object.prototype.hasOwnProperty.call(d,l)&&(c=S[l])){D=d[l];var B=[];for(o=0;o<D.length;o++)if(C=D[o],a=c.hot._acceptedDependencies[C]){if(B.indexOf(a)>=0)continue;B.push(a)}for(o=0;o<B.length;o++){a=B[o];try{a(D)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:l,dependencyId:D[o],error:e}),t.ignoreErrored||R||(R=e)}}}for(o=0;o<I.length;o++){var H=I[o];l=H.module,v=[l];try{u(l)}catch(e){if("function"==typeof H.errorHandler)try{H.errorHandler(e)}catch(a){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:a,orginalError:e,originalError:e}),t.ignoreErrored||R||(R=a),R||(R=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:l,error:e}),t.ignoreErrored||R||(R=e)}}return R?(n("fail"),Promise.reject(R)):(n("idle"),new Promise(function(e){e(g)}))}function u(n){if(S[n])return S[n].exports;var i=S[n]={i:n,l:!1,exports:{},hot:function(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:l!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._acceptedDependencies[e[i]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:r,apply:s,status:function(e){if(!e)return A;b.push(e)},addStatusHandler:function(e){b.push(e)},removeStatusHandler:function(e){var t=b.indexOf(e);t>=0&&b.splice(t,1)},data:m[e]};return l=void 0,t}(n),parents:(w=v,v=[],w),children:[]};return e[n].call(i.exports,i,i.exports,t(n)),i.l=!0,i.exports}var c=window.webpackHotUpdateAnnoyingBird;window.webpackHotUpdateAnnoyingBird=function(e,t){!function(e,t){if(x[e]&&P[e]){for(var n in P[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(f[n]=t[n]);0==--k&&0===T&&o()}}(e,t),c&&c(e,t)};var l,d,f,h,g=!0,p="f4a68f3e7677281d3bb7",y=1e4,m={},v=[],w=[],b=[],A="idle",k=0,T=0,_={},P={},x={},S={};return u.m=e,u.c=S,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="./",u.h=function(){return p},t(2)(u.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r={},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"on",value:function(e,t,n){(r[e]||(r[e]=[])).push({context:n,callback:t})}},{key:"off",value:function(e,t){var n=r[e];if(n){for(var i=n.length-1;i>=0;--i)n[i].callback===t&&n.splice(i,1);0===n.length&&delete r[e]}}},{key:"trigger",value:function(e,t){var n=r[e];n&&n.forEach(function(e){e.callback.call(e.context,t)})}},{key:"reset",value:function(e){e?delete r[e]:r={}}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={bird:{left:"bird.left"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n(3));t.default=i.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(4)),a=i(n(8)),o=i(n(0)),s=i(n(1)),u={};a.default.setUpdate(function(e){for(var t in u)u[t].update(e)}).setDraw(function(){for(var e in u)u[e].draw()}).start(),window.onbeforeunload=function(){a.default.stop()},o.default.on(s.default.bird.left,function(e){u[e]&&l(e),console.log(e+" deleted")});var c=function(e){u[e]=new r.default(d,0,0,e)},l=function(e){u[e]=null,delete u[e]},d={annoy:function(e){u[e]||c(e),u[e].annoy()},sleep:function(e){u[e]||c(e),u[e].sleep()},flyAwayWith:function(e){u[e]||c(e),u[e].flyAwayWithTarget()},comeback:function(e){u[e]&&u[e].comeback()},leave:function(e){u[e]&&u[e].leave()}};t.default=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(5),o=n(7),s=i(n(0)),u=i(n(1)),c="bird",l={width:28,height:28,image:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAAcCAMAAACJdf3QAAAAQlBMVEUAAAC7yrf+/f6eWkLp0H7ywoRXciWdekXayrYNDQ2urmOlg1A9LTQcHBwhISEAAACraFTmsVwAAAD/0zP/v2b/37MhqQe3AAAAFnRSTlMA////////////////////////////VIGNowAAA7NJREFUeJztmdvWqyAMhFkub/P+r7vrAQ2QGTRiu/Und+04nPKZWBtCjx49evTo0ePlIU7t6BU9elwKCcMwQE0EIzj5OqAPj98mUKqL+AAowyDjJ0ztE6Y2fTkZGcA9zoS3k0FNDtEn5KIvpHbFh27ww9kwjhhRQ1u+GiZAW672b4eQXubRptww334V1DzwsvvC0Jb5RbBvBdBE1Nb0lx3QRiGkl/m0tQGi/rhdwdZENIghx7oEVNaZoG/CDBFqaTucYN89fMF7WakJ9cXM4zEpoBfgPWeTpdIL9gkh1NASPukt5nuGebuPjHi2lwnzrYCSMd2AVuAdyFNFqc1DzcNBH6uERKs1eFLqaXJf4HPG2V4WIbG1RSVjLmWmOaBCAC012QAlvuY/IOPcxOnsHg/x+eg92cu2d4BAEz4mqqu76AN0HGRAoqFJDOK7CVBW6llyX+FLDof9okg+JbxUNdGEppoATcXKp7kyP7yh6ky1nU/iuwdQVupZch/rS44jTaAAMeNYMNWGtkGINCk0FQwIP7wf0MRWZwgNbQMU+NgeLmjTnUtKPXveeKgve17NjBlD24f9v7qyb1Y1FUe1PTCBfnhxKYRlcl9mrsneJopNtNDofVYk9wU+0RyV5VWfljo3xtId2rYHq09rLScw0bI2nSKRXKDq+SltldkuLmp5ya4l9+m+lIuyLOsT0/RSmG7Q4h5mPkH+LHi1ZsGr5ksOJtEEayHzZdsodnFds0p2lFhyn+rj7UonKS2v5DRv0ULcG86fCe+umfDqCfPz1CLSQu67aftKKsoPTuArfEosyBYd+YMDPs1btHr+bHi3rmJo2ZBw71gLhU/LbBd+zZfcx/pUmSx/ZqgkQY2f5imNjXkNewbvrqDzhFowfLcDikt2CcUbfLlkGwN4cMgPUrvOa2zMW/O+foRnBrRg+YJ//we1E1C8ybdKZjmIUvq3uYuzC3FD3jG7BzS2zGC/cL+koZJ9MLnnfcHpc64zgPm0VpK9vSs1AA3fjDvyXiGN/KsDtW028LRxQQMlG0NYjHkQwnU0YT4LwrhOpw+sc75CwYsAzV62fJnPO/Ie9aaARhnrXi3A/xkWk/UsEr8unVUf2COHN86F5qv4jpwLBlSX12+Xz2ItrTR2o/1vgFKbRdjuQbuno46uddIxW5wLBtQor1+O5nnnfHpB+g2gVDGvGCtmCiFAQZhzZNM1gfdlgE7v3FvPNccIE+jXuK2ieEbF0pX5mp9Lov0Y0MZ5//SwhsP9A82GjUKOnwdCAAAAAElFTkSuQmCC')"},d={idle:{frames:[0],frequency:0,repeat:!1},blink:{frames:[1,0],frequency:400,repeat:!1},look_around:{frames:[2,0],frequency:1200,repeat:!1},hit:{frames:[11,12,13,12],frequency:20,repeat:!1},walk:{frames:[3,4,5,6,7,8,9,10],frequency:150,repeat:!0},scratch:{frames:[18,19,20,19],frequency:150,repeat:!0},fly:{frames:[21,22,23,22],frequency:60,repeat:!0}},f=function(e){function t(e,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,c,l));return a.targetId=r,a.flyVelocity=.03,a.flyWithTargetVelocity=.01,a.walkVelocity=.04,a.annoying=!1,a.rand=0,a.hitCount=0,a.nextState=null,a.originalTargePosition=a.getOriginalTarget().getBoundingClientRect(),a.cursorInfo={clicked:!1,position:null},a.stateManager.addState({name:"idle",enter:function(){var e=a.getOriginalTarget();a.nextState=null,e.style.position="relative",e.style.top=0,e.style.left=0,a.currentAnimation=d.idle,a.rand=parseInt(5*Math.random())},update:function(){a.adjustIdlePosition()}}),a.stateManager.addState({name:"blinking",enter:function(){a.currentAnimation=d.blink},update:function(){a.adjustIdlePosition()}}),a.stateManager.addState({name:"looking",enter:function(){a.currentAnimation=d.look_around},update:function(){a.adjustIdlePosition()}}),a.stateManager.addState({name:"scratching",enter:function(){a.currentAnimation=d.scratch},update:function(){a.adjustIdlePosition()}}),a.stateManager.addState({name:"hitting",enter:function(){a.currentAnimation=d.hit,a.hitCount++},update:function(){a.adjustIdlePosition()}}),a.stateManager.addState({name:"walking",enter:function(){a.currentAnimation=d.walk},update:function(){a.setRelativePosition(),a.adjustIdlePosition(),a.setFacing()}}),a.stateManager.addState({name:"flying_to_target",enter:function(){if(a.currentAnimation=d.fly,!a.image.flyPosition){var e=a.getTarget(),t=Math.random()*window.innerWidth;a.image.flyPosition={y:-28,x:t,relativeTargetX:.9-Math.random()},a.image.relativePosition.x=e.clientWidth*(.9-Math.random())}},update:function(){a.setFlyFacing(),a.flyToTarget()}}),a.stateManager.addState({name:"running_away",enter:function(){a.currentAnimation=d.fly,a.escapeTarget={},a.escapeTarget=a.getEscapeTarget()},update:function(){a.cursorInfo.birdClicked&&(a.escapeTarget=a.getEscapeTarget()),a.setFlyFacing(),a.flyToTarget()}}),a.stateManager.addState({name:"leaving",enter:function(){a.currentAnimation=d.fly,a.escapeTarget={},a.escapeTarget=a.getEscapeTarget(!0)},update:function(){a.cursorInfo.birdClicked&&(a.escapeTarget=a.getEscapeTarget(!0)),a.setFlyFacing(),a.flyToTarget(),a.isOnTarget()&&(a.destroy(),s.default.trigger(u.default.bird.left,a.targetId))}}),a.stateManager.addState({name:"running_away_with_target",enter:function(){a.currentAnimation=d.fly,a.escapeTarget={},a.escapeTarget=a.getEscapeTarget(!0)},update:function(){a.cursorInfo.birdClicked&&(a.escapeTarget=a.getEscapeTarget(!0)),a.setFlyFacing(),a.flyToTarget(!0)}}),a.stateManager.addTransition({from:"idle",to:"blinking",criteria:function(){var e=(0,o.dateDiffSeconds)(a.stateStartedDate,new Date);return e>=3&&0==a.rand||e>8}}),a.stateManager.addTransition({from:"blinking",to:"idle",criteria:function(){return 1==a.currentAnimationIndex}}),a.stateManager.addTransition({from:"idle",to:"looking",criteria:function(){return(0,o.dateDiffSeconds)(a.stateStartedDate,new Date)>=5&&1==a.rand}}),a.stateManager.addTransition({from:"looking",to:"idle",criteria:function(){return 1==a.currentAnimationIndex}}),a.stateManager.addTransition({from:"idle",to:"scratching",criteria:function(){return(0,o.dateDiffSeconds)(a.stateStartedDate,new Date)>=4&&2==a.rand}}),a.stateManager.addTransition({from:"scratching",to:"idle",criteria:function(){return a.animationLoopCount>1}}),a.stateManager.addTransition({from:["idle","looking","blinking","walking"],to:"hitting",criteria:function(){return a.cursorInfo.clicked}}),a.stateManager.addTransition({from:"hitting",to:"idle",criteria:function(){return 3==a.currentAnimationIndex}}),a.stateManager.addTransition({from:["idle","looking","blinking"],to:"walking",criteria:function(){return a.isCursorOnTarget()}}),a.stateManager.addTransition({from:"walking",to:"idle",criteria:function(){return!a.isCursorOnTarget()}}),a.stateManager.addTransition({from:["idle","flying_to_target"],to:"running_away",criteria:function(){return a.cursorInfo.birdClicked}}),a.stateManager.addTransition({from:"running_away",to:"flying_to_target",criteria:function(){return a.isOnTarget()}}),a.stateManager.addTransition({from:"flying_to_target",to:"idle",criteria:function(){return a.isOnTarget()&&(!a.nextState||"idle"==a.nextState)}}),a.stateManager.addTransition({from:"flying_to_target",to:"running_away_with_target",criteria:function(){return a.isOnTarget()&&"running_away_with_target"==a.nextState}}),a.stateManager.addTransition({from:"running_away_with_target",to:"idle",criteria:function(){return a.isOnTarget()&&"idle"==a.nextState}}),a.getTarget().addEventListener("click",function(e){e.preventDefault(),a.cursorInfo.clicked=!0}),a.image.addEventListener("click",function(e){e.preventDefault(),a.cursorInfo.birdClicked=!0}),document.addEventListener("mousemove",function(e){a.cursorInfo.position=e}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Sprite),r(t,[{key:"update",value:function(e){(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),this.clear()}},{key:"getTarget",value:function(){return"running_away"==this.stateManager.getCurrentStateName()||"running_away_with_target"==this.stateManager.getCurrentStateName()||"leaving"==this.stateManager.getCurrentStateName()?this.escapeTarget:document.getElementById(this.targetId)}},{key:"isCursorOnTarget",value:function(){if(!this.cursorInfo.position)return!1;var e=this.getTarget(),t=e.getBoundingClientRect(),n=Math.abs(this.getDistance());return this.cursorInfo.position.x>=t.left&&this.cursorInfo.position.x<=t.left+e.clientWidth&&this.cursorInfo.position.y>=t.top&&this.cursorInfo.position.y<=t.top+e.clientHeight&&n>.5*l.width}},{key:"getDistance",value:function(){var e=this.getTarget().getBoundingClientRect(),t={};return t.x=this.cursorInfo.position.x-e.left,t.x-this.image.relativePosition.x}},{key:"getFlyDistance",value:function(){var e=this.getTarget().getBoundingClientRect(),t={};return t.x=this.image.flyPosition.x-(e.left+this.image.relativePosition.x-.5*l.width),t.y=e.top-this.image.flyPosition.y-l.width,t}},{key:"setFacing",value:function(){if(this.isCursorOnTarget()){var e=this.getDistance();this.facing=e>0?a.Facing.Right:a.Facing.Left}}},{key:"adjustIdlePosition",value:function(){var e=this.getTarget().getBoundingClientRect();this.image.style.top=e.top-l.width+"px",this.image.style.left=e.left+this.image.relativePosition.x-.5*l.width+"px"}},{key:"setRelativePosition",value:function(){if(this.isCursorOnTarget()){var e=this.getDistance(),t=this.getTarget().getBoundingClientRect();this.image.relativePosition.x+=e*this.walkVelocity,this.image.flyPosition.x=t.left+this.image.relativePosition.x-.5*l.width}}},{key:"flyToTarget",value:function(e){var t=e?this.flyWithTargetVelocity:this.flyVelocity,n=(this.getTarget().getBoundingClientRect(),this.getFlyDistance());if(this.image.flyPosition.x+=n.x*t*-1,this.image.flyPosition.y+=n.y*t,this.image.style.top=this.image.flyPosition.y+"px",this.image.style.left=this.image.flyPosition.x+"px",e){var i=this.getOriginalTarget();i.getBoundingClientRect(),i.style.position="fixed",i.style.top=this.image.flyPosition.y+.99*l.height+"px",i.style.left=this.image.flyPosition.x-this.image.relativePosition.x+.5*l.width}}},{key:"setFlyFacing",value:function(){var e=this.getFlyDistance();this.facing=e.x>0?a.Facing.Left:a.Facing.Right}},{key:"getOriginalTarget",value:function(){return document.getElementById(this.targetId)}},{key:"isOnTarget",value:function(){if(!this.image.flyPosition)return!1;var e=this.getFlyDistance();return Math.abs(e.x)<10&&Math.abs(e.y)<10}},{key:"clear",value:function(){this.cursorInfo.clicked=!1,this.cursorInfo.birdClicked=!1}},{key:"getEscapeTarget",value:function(e){var t=this.getOriginalTarget(),n=Math.random()>.5?1:-1,i=Math.random()>.5?1:-1,r=this.escapeTarget.x||this.image.flyPosition.x,a=this.escapeTarget.y||this.image.flyPosition.y,o=Math.random()*window.innerWidth;return{getBoundingClientRect:function(){return{left:e?o:r+50*Math.random()*n,top:e?-28-t.clientHeight:a+-10*Math.random()*i}},clientWidth:t.clientWidth}}},{key:"annoy",value:function(){this.isOnTarget()||this.stateManager.setCurrentState("flying_to_target")}},{key:"sleep",value:function(){}},{key:"flyAwayWithTarget",value:function(){this.isOnTarget()?this.stateManager.setCurrentState("running_away_with_target"):(this.nextState="running_away_with_target",this.stateManager.setCurrentState("flying_to_target"))}},{key:"comeback",value:function(){var e=this;if("running_away_with_target"==this.stateManager.getCurrentStateName()){var t=this.getOriginalTarget();this.escapeTarget={getBoundingClientRect:function(){return{left:e.originalTargePosition.left,top:e.originalTargePosition.top}},clientWidth:t.clientWidth},this.nextState="idle"}}},{key:"leave",value:function(){"leaving"!=this.stateManager.getCurrentStateName()&&this.stateManager.setCurrentState("leaving")}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sprite=t.Facing=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(6),a={Left:1,Right:2},o=0,s=function(){function e(t,n,i,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=++o,this.manager=t,this.name=s,this.spritesheet=u,this.stateManager=new r.EntityStateManager,this.spriteElapsedTime=0,this.currentAnimation=null,this.currentAnimationIndex=0,this.stateStartedDate=new Date,this.animationCount=0,this.animationLoopCount=0,this.facing=a.Right,this.image=document.createElement("div"),this.image.style.width=this.spritesheet.width+"px",this.image.style.height=this.spritesheet.height+"px",this.image.style.position="absolute",this.image.style.left=n+"px",this.image.style.top=i+"px",this.image.style.background=this.spritesheet.image,this.image.relativePosition={x:.5*this.spritesheet.width,y:0},document.body.appendChild(this.image)}return i(e,[{key:"update",value:function(e){if(this.image){var t=this.stateManager.update(e);this.setAnimationIndex(e),t&&(this.animationCount=0,this.currentAnimationIndex=0,this.animationLoopCount=0,this.animationCount++,this.stateStartedDate=new Date)}}},{key:"draw",value:function(){this.currentAnimation&&(this.image.style["background-position-x"]=4.346*this.currentAnimation.frames[this.currentAnimationIndex]+"%",this.image.style.transform=this.facing==a.Right?"scaleX(1)":"scaleX(-1)")}},{key:"setAnimationIndex",value:function(e){this.currentAnimation&&(this.spriteElapsedTime+=e,this.spriteElapsedTime<this.currentAnimation.frequency||(this.spriteElapsedTime=0,this.currentAnimation.repeat?(this.currentAnimationIndex==this.currentAnimation.frames.length-1&&this.animationLoopCount++,this.currentAnimationIndex=++this.currentAnimationIndex%this.currentAnimation.frames.length):this.currentAnimationIndex<this.currentAnimation.frames.length-1&&this.currentAnimationIndex++))}},{key:"destroy",value:function(){this.currentAnimation=null,this.image.parentNode.removeChild(this.image),this.image=null}}]),e}();t.Facing=a,t.Sprite=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r={NotInitialized:1,Initializing:2,Active:3,Finishing:4,Finished:5},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getCurrentStateName=function(){return this.currentState.name},this.states={},this.transitions={},this.statePhase=r.NotInitialized,this.currentState=null,this.currentTransition=null}return i(e,[{key:"addState",value:function(e){this.states[e.name]=e,this.currentState||(this.currentState=e)}},{key:"addTransition",value:function(e){var t=e.from+"_to_"+e.to;this.transitions[t]=e}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"getStateByName",value:function(e){return this.states[e]}},{key:"setCurrentState",value:function(e){this.statePhase=r.NotInitialized,this.currentState=this.states[e]}},{key:"update",value:function(){var e=this,t=!1;switch(this.statePhase){case r.NotInitialized:this.statePhase=r.Initializing,this.currentState.enter(),this.statePhase=r.Active,t=!0;break;case r.Active:this.currentTransition=null;for(var n=this.getTransitionsByFromState(this.currentState.name),i=0;i<n.length;i++)if(n[i].criteria()){this.currentTransition=n[i];break}this.currentTransition?this.currentState.exit?(this.statePhase=r.Finishing,this.currentState.exit().then(function(){e.statePhase=r.NotInitialized,e.currentState=e.states[e.currentTransition.to]})):(this.statePhase=r.NotInitialized,this.currentState=this.states[this.currentTransition.to]):this.currentState.update()}return t}},{key:"getTransitionsByFromState",value:function(e){var t=[];for(var n in this.transitions)-1!=(this.transitions[n].from instanceof Array?this.transitions[n].from:[this.transitions[n].from]).indexOf(e)&&t.push(this.transitions[n]);return t}}]),e}();t.StatePhase=r,t.EntityStateManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dateDiffSeconds=function(e,t){return(t-e)/1e3}},function(e,t,n){"use strict";function i(e){if(r=b(i),!(e<u+p)){for(s+=e-u,u=e,T(e,s),e>f+d&&(c=l*h*1e3/(e-f)+(1-l)*c,f=e,h=0),h++,g=0;s>=o;)if(_(o),s-=o,++g>=240){v=!0;break}P(s/o),x(c,v),v=!1}}Object.defineProperty(t,"__esModule",{value:!0});var r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=1e3/60,s=0,u=0,c=60,l=.9,d=1e3,f=0,h=0,g=0,p=0,y=!1,m=!1,v=!1,w="object"===("undefined"==typeof window?"undefined":a(window))?window:root,b=w.requestAnimationFrame||function(){var e,t,n=Date.now();return function(i){return e=Date.now(),t=Math.max(0,o-(e-n)),n=e+t,setTimeout(function(){i(e+t)},t)}}(),A=w.cancelAnimationFrame||clearTimeout,k=function(){},T=k,_=k,P=k,x=k,S={getSimulationTimestep:function(){return o},setSimulationTimestep:function(e){return o=e,this},getFPS:function(){return c},getMaxAllowedFPS:function(){return 1e3/p},setMaxAllowedFPS:function(e){return void 0===e&&(e=1/0),0===e?this.stop():p=1e3/e,this},resetFrameDelta:function(){var e=s;return s=0,e},setBegin:function(e){return T=e||T,this},setUpdate:function(e){return _=e||_,this},setDraw:function(e){return P=e||P,this},setEnd:function(e){return x=e||x,this},start:function(){return m||(m=!0,r=b(function(e){P(1),y=!0,u=e,f=e,h=0,r=b(i)})),this},stop:function(){return y=!1,m=!1,A(r),this},isRunning:function(){return y}};t.default=S}]).default});